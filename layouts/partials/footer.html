{{ $p := .data }}
{{ $c := .context }}
{{ $mediaPage := $c.Site.GetPage "page" "media/index.md"}}

	<!-- Footer -->
	{{ if eq $c.RelPermalink "/" }}
		<div id="footer">
			<div class="container">
				<div class="row">
					<!-- Tweets -->
						<section class="6u 12u(mobile)" id="twitter">
							<header>
								<h2 class="icon fa-twitter circled"><span class="label">{{ $p.Params.miniprojects_title }}</span></h2>
							</header>
							<ul class="divided tweets">

							</ul>
						</section>

					<!-- Miniprojects -->
						<section class="6u 12u(mobile)" id="projects">
							<header>
								<a href="http://github.com/davidayalas" title="Mini projects, mini utilities"><h2 class="icon fa-file circled"><span class="label">{{ $p.Params.miniprojects_title }}</span></h2></a>
							</header>
							<ul class="divided">
								{{ range $p.Params.miniprojects }}
								<li><article class="post stub"><header><h3><a href="{{ .link }}" class="notranslate">{{ .title }}</a></h3></header><p>{{ safeHTML (markdownify .description) }}</p></article></li>
								{{ end }}
							</ul>
							<footer>
								<a href="https://github.com/davidayalas?tab=repositories" class="button">More miniprojects</a>
							</footer>
						</section>
				</div>
			</div>
		</div>

	<!-- Main -->
		{{ if and (isset $p.Params "architecture_title") (ne (string $p.Params.architecture_title) "") }}
		<div class="style2" style="background: #ddd; padding-top:1em; padding-bottom:2em">
			<article id="architecture" class="container special">
				<header>
					<h2>{{ $p.Params.architecture_title }}</h2>
				</header>
				<img src="{{ $p.Params.architecture_diagram }}" class="diagram" alt="architecture diagram" />
			</article>
		</div>
		{{ end }}
	{{ end }}

	{{ if eq $c.Permalink "/" }}
		<div class="contact style3">
			<div class="container" >
				<header>
					<h2>{{ $p.Params.contact_title }}</h2>
				</header>				
				<form action="/thanks" name="contact" class="10u 12u(mobile)" netlify>
					<div class="row">
						<div class="6u 12u(mobile)"><input type="text" name="name" placeholder="Name" required /></div>
						<div class="6u 12u(mobile)"><input type="email" name="email" placeholder="Email"  required /></div>
					</div>
					<div class="12u"><textarea name="message" placeholder="Message" required></textarea></div>
				    <div data-netlify-recaptcha></div>
					<div class="col-12">
						<ul class="actions special">
							<li><input type="submit" class="button" value="Send" /></li>
							<li><input type="reset" class="button alt" value="Reset" /></li>
						</ul>
					</div>
				</form>

			</div>
		</div>
	{{ end }}
		
		<div class="footer">
			<div class="container">
				<div class="row">
					<div class="12u">
						<!-- Copyright -->
							<div class="copyright">
								<span class="notranslate">Powered By: </span>
								<a href="http://gohugo.io/"><img src="/images/hugo.png" title="Hugo" alt="Hugo" class="ico" /></a>
								<a href="https://www.netlify.com/"><img src="/images/netlify.ico" title="Netlify" alt="Netlify" class="ico" /></a>
								<a href="https://github.com/"><img src="/images/github2.png" alt="Github" title="Github" class="ico" /></a> 
								<a href="https://developers.google.com/apps-script/"><img src="/images/gas.png" title="Google Apps Script" alt="Google Apps Script" class="ico" /></a>
								<br />
								Design: <a href="https://html5up.net/helios">HTML5 UP</a> 
							</div>

						<!-- Edit -->
							<div class="pull-right editpage">
								{{ if eq $c.RelPermalink "/" }}
								<a href="/admin/#/collections/home/entries/home"><i class="fa fa-pencil" aria-hidden="true"></i> Edit this page</a> &nbsp;
								{{ end }}

								<a href="/admin/#/collections/gallery/new"><i class="fa fa-plus" aria-hidden="true"></i> Add new image</a>
							</div>
					</div>
				</div>
			</div>
		</div>
</div>

<!-- Scripts -->
{{if $p.Params.header}}
	{{ $image := $mediaPage.Resources.GetMatch (replace $p.Params.header "/media/" "") }}
	{{ $c.Scratch.Set "header" ($image.Resize (print $image.Width "x" $image.Height " q60")) }}
	{{ if gt $image.Width 1600 }}
		{{ $c.Scratch.Set "header" ($image.Resize "1600x q90") }}
	{{ end }}
<script defer>
	var headerImage = '{{ ($c.Scratch.Get "header").RelPermalink }}';
</script>
{{end }}
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js" defer></script>		
<script src="/assets/js/jquery.min.js" defer></script>
<script src="/assets/js/jquery.dropotron.min.js" defer></script>
<script src="/assets/js/jquery.scrolly.min.js" defer></script>
<script src="/assets/js/jquery.onvisible.min.js" defer></script>
<script src="/assets/js/skel.min.js" defer></script>
<script src="/assets/js/util.js" defer></script>
<!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js" defer></script><![endif]-->
<script src="/assets/js/main.js" defer></script>
<script src="/js/custom.js" defer></script>
<script defer>
  if (window.netlifyIdentity) {
    window.netlifyIdentity.on("init", user => {
      if (!user) {
        window.netlifyIdentity.on("login", () => {
          document.location.href = "/admin/#/collections/home/entries/home";
        });
      }
    });
  }
</script>  
